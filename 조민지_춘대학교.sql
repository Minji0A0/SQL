DROP TABLE "TB_GRADE";
DROP TABLE "TB_CLASS_PROFESSOR";
DROP TABLE "TB_CLASS";
DROP TABLE "TB_STUDENT";
DROP TABLE "TB_DEPARTMENT";
DROP TABLE "TB_PROFESSOR";


CREATE TABLE "TB_PROFESSOR" (
	"PROFESSOR_NO"	VARCHAR2(10)		NOT NULL,
	"PROFESSOR_NAME"	VARCHAR2(30)		NOT NULL,
	"PROFESSOR_SSN"	VARCHAR2(14)		NULL,
	"PROFESSOR_ADDRESS"	VARCHAR2(100)		NULL,
	"DEPARTMENT_NO"	VARCHAR2(10)		NULL
);

COMMENT ON COLUMN "TB_PROFESSOR"."DEPARTMENT_NO" IS 'TB_DEPARTMENT';


CREATE TABLE "TB_DEPARTMENT" (
	"DEPARTMENT_NO"	VARCHAR2(10)		NOT NULL,
	"DEPARTMENT_NAME"	VARCHAR2(20)		NOT NULL,
	"CATEGORY"	VARCHAR2(20)		NULL,
	"OPEN_YN"	CHAR(1)		NULL,
	"CAPACITY"	NUMBER		NULL
);



CREATE TABLE "TB_STUDENT" (
	"STUDENT_NO"	VARCHAR2(10)		NOT NULL,
	"STUDENT_NAME"	VARCHAR2(30)		NOT NULL,
	"STUDENT_SSN"	VARCHAR2(14)		NULL,
	"STUDENT_ADDRESS"	VARCHAR2(100)		NULL,
	"ENTRANCE_DATE"	DATE		NULL,
	"ABSENCE_YN"	CHAR(1)		NULL,
	"DEPARTMENT_NO"	VARCHAR2(10)		NOT NULL,
	"COACH_PROFESSOR_NO"	VARCHAR2(10)		NOT NULL
);

COMMENT ON COLUMN "TB_STUDENT"."DEPARTMENT_NO" IS 'TB_DEPARTMENT';

COMMENT ON COLUMN "TB_STUDENT"."COACH_PROFESSOR_NO" IS 'TB_PROFESSOR';



CREATE TABLE "TB_CLASS" (
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"PREATTENDING_CLASS_NO"	VARCHAR2(10)		NULL,
	"CLASS_NAME"	VARCHAR2(10)		NOT NULL,
	"CLASS_TYPE"	VARCHAR2(10)		NULL,
	"DEPARTMENT_NO"	VARCHAR2(10)		NOT NULL
);

COMMENT ON COLUMN "TB_CLASS"."DEPARTMENT_NO" IS 'TB_DEPARTMENT';





CREATE TABLE "TB_CLASS_PROFESSOR" (
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"PROFESSOR_NO"	VARCHAR2(10)		NOT NULL
);

COMMENT ON COLUMN "TB_CLASS_PROFESSOR"."CLASS_NO" IS 'TB_CLASS';

COMMENT ON COLUMN "TB_CLASS_PROFESSOR"."PROFESSOR_NO" IS 'TB_PROFESSOR';





CREATE TABLE "TB_GRADE" (
	"TERM_NO"	VARCHAR2(10)		NOT NULL,
	"STUDENT_NO"	VARCHAR2(10)		NOT NULL,
	"CLASS_NO"	VARCHAR2(10)		NOT NULL,
	"POINT"	NUMBER(3,2)		NULL
);

COMMENT ON COLUMN "TB_GRADE"."STUDENT_NO" IS 'TB_STUDENT';

COMMENT ON COLUMN "TB_GRADE"."CLASS_NO" IS 'TB_CLASS';






ALTER TABLE "TB_DEPARTMENT" ADD CONSTRAINT "PK_TB_DEPARTMENT" PRIMARY KEY (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_STUDENT" ADD CONSTRAINT "PK_TB_STUDENT" PRIMARY KEY (
	"STUDENT_NO"
);

ALTER TABLE "TB_CLASS" ADD CONSTRAINT "PK_TB_CLASS" PRIMARY KEY (
	"CLASS_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "PK_TB_CLASS_PROFESSOR" PRIMARY KEY (
	"CLASS_NO",
	"PROFESSOR_NO"
);

ALTER TABLE "TB_PROFESSOR" ADD CONSTRAINT "PK_TB_PROFESSOR" PRIMARY KEY (
	"PROFESSOR_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "PK_TB_GRADE" PRIMARY KEY (
	"TERM_NO",
	"STUDENT_NO",
	"CLASS_NO"
);

ALTER TABLE "TB_STUDENT" ADD CONSTRAINT "FK_TB_DEPARTMENT_TO_TB_STUDENT_1" FOREIGN KEY (
	"DEPARTMENT_NO"
)
REFERENCES "TB_DEPARTMENT" (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_STUDENT" ADD CONSTRAINT "FK_TB_PROFESSOR_TO_TB_STUDENT_1" FOREIGN KEY (
	"COACH_PROFESSOR_NO"
)
REFERENCES "TB_PROFESSOR" (
	"PROFESSOR_NO"
);

ALTER TABLE "TB_CLASS" ADD CONSTRAINT "FK_TB_DEPARTMENT_TO_TB_CLASS_1" FOREIGN KEY (
	"DEPARTMENT_NO"
)
REFERENCES "TB_DEPARTMENT" (
	"DEPARTMENT_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "FK_TB_CLASS_TO_TB_CLASS_PROFESSOR_1" FOREIGN KEY (
	"CLASS_NO"
)
REFERENCES "TB_CLASS" (
	"CLASS_NO"
);

ALTER TABLE "TB_CLASS_PROFESSOR" ADD CONSTRAINT "FK_TB_PROFESSOR_TO_TB_CLASS_PROFESSOR_1" FOREIGN KEY (
	"PROFESSOR_NO"
)
REFERENCES "TB_PROFESSOR" (
	"PROFESSOR_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "FK_TB_STUDENT_TO_TB_GRADE_1" FOREIGN KEY (
	"STUDENT_NO"
)
REFERENCES "TB_STUDENT" (
	"STUDENT_NO"
);

ALTER TABLE "TB_GRADE" ADD CONSTRAINT "FK_TB_CLASS_TO_TB_GRADE_1" FOREIGN KEY (
	"CLASS_NO"
)
REFERENCES "TB_CLASS" (
	"CLASS_NO"
);

select * from user_constraints where constraint_name= 'FK_TB_PROFESSOR_TO_TB_STUDENT_1';
select * from user_constraints where constraint_name= 'PK_TB_PROFESSOR';

select * from TB_PROFESSOR;

INSERT INTO "TB_PROFESSOR" ("PROFESSOR_NO", "PROFESSOR_NAME", "PROFESSOR_SSN", "PROFESSOR_ADDRESS", "DEPARTMENT_NO")
VALUES ('PROF001', '김수지', '12345678901234', '서울시 강남구', 'DEPT001');

INSERT INTO "TB_PROFESSOR" ("PROFESSOR_NO", "PROFESSOR_NAME", "PROFESSOR_SSN", "PROFESSOR_ADDRESS", "DEPARTMENT_NO")
VALUES ('PROF002', '최수경', '98765432109876', '서울시 마포구', 'DEPT002');



INSERT INTO "TB_DEPARTMENT" ("DEPARTMENT_NO", "DEPARTMENT_NAME", "CATEGORY", "OPEN_YN", "CAPACITY")
VALUES ('DEPT001', '컴퓨터 과학', '공학', 'Y', 100);

INSERT INTO "TB_DEPARTMENT" ("DEPARTMENT_NO", "DEPARTMENT_NAME", "CATEGORY", "OPEN_YN", "CAPACITY")
VALUES ('DEPT002', '전기 공학', '공학', 'Y', 80);


INSERT INTO "TB_STUDENT" ("STUDENT_NO", "STUDENT_NAME", "STUDENT_SSN", "STUDENT_ADDRESS", "ENTRANCE_DATE", "ABSENCE_YN", "DEPARTMENT_NO", "COACH_PROFESSOR_NO")
VALUES ('STU001', '강정하', '78901234567890', '서울시 종로구', TO_DATE('2022-02-15', 'YYYY-MM-DD'), 'N', 'DEPT001', 'PROF001');

INSERT INTO "TB_STUDENT" ("STUDENT_NO", "STUDENT_NAME", "STUDENT_SSN", "STUDENT_ADDRESS", "ENTRANCE_DATE", "ABSENCE_YN", "DEPARTMENT_NO", "COACH_PROFESSOR_NO")
VALUES ('STU002', '윤은수', '23456789012345', '서울시 서초구', TO_DATE('2022-03-20', 'YYYY-MM-DD'), 'Y', 'DEPT002', 'PROF002');

select * from tb_professor;

INSERT INTO "TB_CLASS" ("CLASS_NO", "PREATTENDING_CLASS_NO", "CLASS_NAME", "CLASS_TYPE", "DEPARTMENT_NO")
VALUES ('CLS001', NULL, 'JAVA입문', '강의', 'DEPT001');

INSERT INTO "TB_CLASS" ("CLASS_NO", "PREATTENDING_CLASS_NO", "CLASS_NAME", "CLASS_TYPE", "DEPARTMENT_NO")
VALUES ('CLS002', 'CLS001', 'JAVA실습', '실습', 'DEPT001');


INSERT INTO "TB_CLASS_PROFESSOR" ("CLASS_NO", "PROFESSOR_NO")
VALUES ('CLS001', 'PROF001');

INSERT INTO "TB_CLASS_PROFESSOR" ("CLASS_NO", "PROFESSOR_NO")
VALUES ('CLS002', 'PROF002');


INSERT INTO "TB_GRADE" ("TERM_NO", "STUDENT_NO", "CLASS_NO", "POINT")
VALUES ('TERM001', 'STU001', 'CLS001', 3.5);

INSERT INTO "TB_GRADE" ("TERM_NO", "STUDENT_NO", "CLASS_NO", "POINT")
VALUES ('TERM001', 'STU002', 'CLS001', 4.0);
